<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Install Archlinux with Btrfs"><title>è®©ArchLinuxè¿è¡Œåœ¨Btrfsä¸Šï¼</title><link rel=canonical href=https://sharelter.github.io/p/archlinux-btrfs/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="è®©ArchLinuxè¿è¡Œåœ¨Btrfsä¸Šï¼"><meta property='og:description' content="Install Archlinux with Btrfs"><meta property='og:url' content='https://sharelter.github.io/p/archlinux-btrfs/'><meta property='og:site_name' content='Sharelter'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2023-03-12T09:21:48+00:00'><meta property='article:modified_time' content='2023-03-12T09:21:48+00:00'><meta property='og:image' content='https://sharelter.github.io/p/archlinux-btrfs/btrfs-logo.jpg'><meta name=twitter:title content="è®©ArchLinuxè¿è¡Œåœ¨Btrfsä¸Šï¼"><meta name=twitter:description content="Install Archlinux with Btrfs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://sharelter.github.io/p/archlinux-btrfs/btrfs-logo.jpg'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/sharelter-avatar_hu_d55e0afb08faa59.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Sharelter</a></h1><h2 class=site-description>å–µï½</h2></div></header><ol class=menu-social><li><a href=https://github.com/Sharelter target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/friend-links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Friend Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ç¼˜èµ·>ç¼˜èµ·</a></li><li><a href=#åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ>åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</a></li><li><a href=#btrfså­å·>btrfså­å·</a></li><li><a href=#æŒ‚è½½>æŒ‚è½½</a></li><li><a href=#æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯>æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯</a></li><li><a href=#end>End</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/archlinux-btrfs/><img src=/p/archlinux-btrfs/btrfs-logo_hu_9227227ee5b2493c.jpg srcset="/p/archlinux-btrfs/btrfs-logo_hu_9227227ee5b2493c.jpg 800w, /p/archlinux-btrfs/btrfs-logo_hu_fdb4df05a79083fe.jpg 1600w" width=800 height=510 loading=lazy alt="Featured image of post è®©ArchLinuxè¿è¡Œåœ¨Btrfsä¸Šï¼"></a></div><div class=article-details><header class=article-category><a href=/categories/linux/ style=background-color:orange;color:#fff>Linux</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/archlinux-btrfs/>è®©ArchLinuxè¿è¡Œåœ¨Btrfsä¸Šï¼</a></h2><h3 class=article-subtitle>Install Archlinux with Btrfs</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 12, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><h2 id=ç¼˜èµ·>ç¼˜èµ·</h2><p>æœ€è¿‘ä¸»åŠ›laptopä¸Šé¢çš„Archæ ¹ç›®å½•ä½™é‡ä¸€ç›´åœ¨1.5GiBä¸Šä¸‹å¾˜å¾Šï¼Œ
ä»Šå¤©æ»šå®Œä¹‹å<code>/</code>ä»…å‰©çš„900+MB å·²ç»ä¸èƒ½å®ŒæˆArchçš„æ¯æ—¥ä¸€æ»šäº†</p><p>å› ä¸ºæˆ‘åœ¨å®‰è£…è¿™ä¸ªArchçš„æ—¶å€™ä½¿ç”¨äº†å›ºå®šçš„åˆ†åŒºæ–¹å¼ï¼Œ
è€Œä¸”æ ¹ç›®å½•åªåˆ†é…äº†20GB, å®‰è£…ä½¿ç”¨æ¡Œé¢ä½œä¸šç³»ç»Ÿçš„è¯ï¼Œ
å¾ˆè½»æ¾å°±å¯ä»¥åƒå…‰è¿™ç‚¹ç©ºé—´</p><p>ä¹‹å‰çš„åˆ†åŒºæ–¹å¼å¤§æ¦‚å¦‚ä¸‹è¡¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>/dev/nvme0n1---
</span></span><span class=line><span class=cl>             |
</span></span><span class=line><span class=cl>             --- partation1 - /root(ext4, 20G)
</span></span><span class=line><span class=cl>             |
</span></span><span class=line><span class=cl>             --- partation2 - /home(f2fs, 460G)
</span></span></code></pre></td></tr></table></div></div><p>ä¸å¹¸çš„æ˜¯æˆ‘åœ¨ä½¿ç”¨çš„ç£ç›˜é‡Œé¢æ²¡æœ‰ç•™ä¸‹ç©ºä½™çš„æœªåˆ†é…ç©ºé—´ç»™æ ¹ç›®å½•åˆ†åŒºæ‰©å……ï¼Œ
æ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯é‡è£…æ•´ä¸ªOS</p><p>å¦‚æœä¸å¹²é¢„çš„è¯ï¼Œ æˆ‘çš„å¼€å‘ç¯å¢ƒä¼šåœ¨ä¸è¿œçš„å°†æ¥boomæ‰</p><p>é‚£ä¹ˆäº‹ä¸å®œè¿Ÿï¼Œ å¼€å·¥ï¼</p><blockquote><p>åœ¨æ±‚æ•™c10sä¹‹åï¼Œå¥¹æ‰”å‡ºäº†å¦‚ä¸‹è¡¨æƒ…
<img src=/p/archlinux-btrfs/btrfs-recommend.jpg width=437 height=512 srcset="/p/archlinux-btrfs/btrfs-recommend_hu_dea6e9e33691df18.jpg 480w, /p/archlinux-btrfs/btrfs-recommend_hu_72903f8eaf84d948.jpg 1024w" loading=lazy alt=recommend-btrfs class=gallery-image data-flex-grow=85 data-flex-basis=204px></p></blockquote><p>å—¯ã€‚ã€‚è¢«å¼ºçƒˆå®‰åˆ©äº†btrfs</p><p>ä¹‹å‰ä¹Ÿæœ‰å¬è¿‡btrfsè¿™ä¸ªä¸œä¸œï¼Œä½†æ˜¯<del>å› ä¸ºæ‡’</del>è¿˜æ²¡æœ‰ç”¨è¿‡</p><p>åœ¨Archwikiæ‰¾åˆ°btrfsçš„<a class=link href=https://wiki.archlinux.org/title/Btrfs target=_blank rel=noopener>wikipage</a>
å‘ç°è‡ªå¸¦å¾ˆå¤šé«˜çº§çš„åŠŸèƒ½ ä¾‹å¦‚é€»è¾‘å·ç®¡ç†ã€å¿«ç…§ã€RAID &mldr;etc.</p><blockquote><p>Btrfs is a modern copy on write (CoW) filesystem for Linux aimed at implementing advanced features while also focusing on fault tolerance, repair and easy administration. Jointly developed at multiple companies, Btrfs is licensed under the GPL and open for contribution from anyone.</p></blockquote><p>çœ‹èµ·æ¥å¾ˆå¥½è€¶ï¼Œä¸Šè½¦ï¼</p><blockquote><p>Tips: btrfsçš„å¼€å‘ååˆ†æ´»è·ƒï¼Œ å»ºè®®ä½¿ç”¨æœ€æ–°çš„å†…æ ¸ï¼Œå°½é‡é¿å…ä½¿ç”¨ç¥–ä¼ çš„è€ç‰ˆæœ¬å†…æ ¸ä»¥å¾—åˆ°æœ€ä½³çš„ä½“éªŒ</p></blockquote><h2 id=åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ>åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</h2><p>å…ˆåœ¨ç£ç›˜ä¸Šé¢åˆ›å»ºä¸€ä¸ªbtrfsçš„æ–‡ä»¶ç³»ç»Ÿ
<code>sudo mkfs.btrfs -L mylabel /dev/nvme0n1p2</code></p><p>btrfsä¹Ÿå¯ä»¥ä»¥éœ¸å æ•´ä¸ªç£ç›˜çš„æ–¹å¼è¿›è¡Œä½¿ç”¨ï¼Œ æ­¤æ—¶è¿™ä¸ªç£ç›˜çš„åˆ†åŒºè¡¨å°±ç”±btrfsæ¥ç®¡äº†</p><p>å› ä¸ºæˆ‘è¿˜éœ€è¦ESP partationæ¥ä½¿ç”¨UEFIå¯åŠ¨ï¼Œ å°±ä¸å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼</p><p>è¿™é‡Œæˆ‘çš„ç£ç›˜æ˜¯åˆ†å¥½äº†åŒºçš„ï¼Œ ä¸€ä¸ª2GBçš„FAT32åˆ†åŒºæ¥å®ç°UEFIå¯åŠ¨ å‰©ä¸‹çš„æ‰€æœ‰ç©ºé—´ç»™btrfs</p><p>æ“ä½œåˆ°è¿™ä¸€æ­¥ï¼Œ å·²ç»å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥å¾€è¿™äº›æ–‡ä»¶ç³»ç»Ÿä¸Šé¢å®‰è£…ç³»ç»Ÿäº†</p><p>ä½†æ˜¯ï¼Œ è¿™æ ·ä½¿ç”¨btrfsä¸èƒ½ç”¨ä¸Šå®ƒçš„è®¸å¤šé«˜çº§åŠŸèƒ½
æ­¤æ—¶å¦‚æœç›´æ¥æŒ‚è½½è¿™ä¸ªåˆ†åŒºçš„è¯ï¼Œ å¯ä»¥äº«å—åˆ°btrfsçš„CoW(å†™æ—¶å¤åˆ¶) ç‰¹æ€§æ¥å‡å°‘é—ªå­˜è®¾å¤‡çš„æŸè€—ï¼Œå¯ä»¥å¯ç”¨å‹ç¼©ã€ã€ç±»ä¼¼çš„ä¼˜åŠ¿</p><p>ç»§ç»­æ“ä½œï¼Œ éœ€è¦ä½¿ç”¨ç”¨æˆ·ç©ºé—´çš„btrfså·¥å…·<code>btrfs-progs</code>
åœ¨ArchLinuxä¸Šé¢è¦å®‰è£…å®ƒï¼Œåªéœ€
<code>sudo pacman -S btrfs-progs</code></p><h2 id=btrfså­å·>btrfså­å·</h2><p>åˆ›å»ºå¥½btrfsæ–‡ä»¶ç³»ç»Ÿä¹‹åï¼Œ å°±æ‹¥æœ‰äº†ä¸€ä¸ª<code>ID=5</code>çš„é¡¶çº§å­å·</p><p>åˆ›å»ºä¸€ä¸ªç©ºé—²çš„ç›®å½•(ä¾‹å¦‚<code>/btrfs</code>) æŠŠæ–‡ä»¶ç³»ç»Ÿçš„é¡¶çº§å­å·æŒ‚ä¸Šï¼Œ
å°±å¯ä»¥ç”¨ <code>btrfs subvolume create /path/to/subvolume</code>æ¥åˆ›å»ºå­å·</p><p>è¿™é‡Œï¼Œ æˆ‘ä¸º<code>/root, /home, /swap</code>è¿™ä¸‰ä¸ªç›®å½•åœ¨é¡¶çº§å­å·ä¸‹é¢åˆ›å»ºäº†ä¸‰ä¸ªå­å·</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>btrfs subvoleme create /btrfs/subvol_root
</span></span><span class=line><span class=cl>btrfs subvolume create /btrfs/subvol_home
</span></span></code></pre></td></tr></table></div></div><p>Archwikiæ¨èä¸ºswapæ–‡ä»¶å•ç‹¬åˆ›å»ºä¸€ä¸ªå­å·ç›´å±äºé¡¶çº§å­å·çš„å­å·æ¥æŒ‚è½½:
<code>btrfs subvolume create /btrfs/@swap</code></p><p>btrfs-progs 6.1ç‰ˆæœ¬ä¹‹åï¼Œæä¾›äº†ä¸€ä¸ªç›´æ¥åˆ›å»ºswapæ–‡ä»¶çš„å‘½ä»¤:
<code>btrfs filesystem mkswapfile --size 8g /btrfs/@swap/swapfile</code></p><p>å¯ä»¥é€šè¿‡<code>--size</code>æ¥å®šä¹‰åˆ›å»ºçš„ç¼“å­˜æ–‡ä»¶çš„å¤§å°ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„swapæ–‡ä»¶å°±å¯ä»¥ç›´æ¥æŒ‚è½½äº†ï½</p><p>é€šè¿‡<code>btrfs subvolume list -p /mnt</code> å¯ä»¥åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿä¸‹é¢çš„å­å·</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>ID 256 gen 10069 parent 5 top level 5 path subvol_root
</span></span><span class=line><span class=cl>ID 257 gen 10069 parent 5 top level 5 path subvol_home
</span></span><span class=line><span class=cl>ID 258 gen 9195 parent 5 top level 5 path @swap
</span></span><span class=line><span class=cl>ID 259 gen 17 parent 256 top level 256 path subvol_root/var/lib/portables
</span></span><span class=line><span class=cl>ID 260 gen 18 parent 256 top level 256 path subvol_root/var/lib/machines
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šé¢æ˜¯æˆ‘çš„å­å·åˆ—è¡¨</p><h2 id=æŒ‚è½½>æŒ‚è½½</h2><p>åœ¨æŒ‚è½½çš„æ—¶å€™åŠ ä¸Š<code>subvol=/path/to/subvolume</code>æˆ–è€…<code>subvolid=?</code>ï¼Œbtrfså­å·å°±å¯ä»¥åƒæ–‡ä»¶ç³»ç»Ÿåˆ†åŒºä¸€æ ·è¢«æŒ‚è½½</p><p>æ¨èåˆ›å»ºä¸€ä¸ªå­å·æ¥æŒ‚è½½æ ¹ç›®å½•ï¼Œè¿™æ ·ä¼šä¸ºä»¥åæ›´æ”¹å­å·å¸ƒå±€å’Œå¿«ç…§å¸¦æ¥éå¸¸å¤§çš„ä¾¿åˆ©</p><p>æˆ‘æ·»åŠ äº† <code>compress=zstd</code>å¯ç”¨zstdå‹ç¼©æ–¹å¼ï¼Œ<code>discard=async</code>å¯ç”¨SSD-TRIM å‚æ•°
Update: å»æ‰äº†<code>autodefrag</code>,åœ¨SSDä¸Šé¢ä½¿ç”¨è¿™ä¸ªé€‰é¡¹å¼Šå¤§äºåˆ©</p><p>å› ä¸ºæ˜¯åœ¨å®‰è£…è¿‡ç¨‹ä¸­æ“ä½œï¼Œ æŒ‚è½½çš„é€‰é¡¹éƒ½ä¼šè¢«<code>genfstab</code>è‡ªåŠ¨æ’åˆ°<code>/etc/fstab</code>å½“ä¸­</p><p>æˆ‘çš„<code>/etc/fstab</code>å¦‚ä¸‹:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl># /dev/nvme0n1p2 LABEL=Arch
</span></span><span class=line><span class=cl>UUID=efeb8313-4210-4499-a805-d0f97e57c549 /          btrfs      rw,relatime,compress=zstd:3,ssd,discard=async,space_cache=v2,autodefrag,subvolid=256,subvol=/subvol_root 0 0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># /dev/nvme0n1p1
</span></span><span class=line><span class=cl>UUID=45BB-F7D1       /boot      vfat       rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro 0 2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># /dev/nvme0n1p2 LABEL=Arch
</span></span><span class=line><span class=cl>UUID=efeb8313-4210-4499-a805-d0f97e57c549 /home      btrfs      rw,relatime,compress=zstd:3,ssd,discard=async,space_cache=v2,autodefrag,subvolid=257,subvol=/subvol_home 0 0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># /dev/nvme0n1p2 LABEL=Arch
</span></span><span class=line><span class=cl>UUID=efeb8313-4210-4499-a805-d0f97e57c549 /swap      btrfs      rw,relatime,compress=zstd:3,ssd,discard=async,space_cache=v2,autodefrag,subvolid=258,subvol=/@swap 0 0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/swap/swapfile       none       swap       defaults   0 0
</span></span></code></pre></td></tr></table></div></div><h2 id=æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯>æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯</h2><p>æ²¡æœ‰æ•ˆéªŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶æŸåæ˜¯æ— å£°å‘ç”Ÿçš„</p><p>btrfsæä¾›äº†<code>scrub</code>æ¥è¿›è¡Œåœ¨çº¿çš„æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥</p><p>BtrfsWikiè¿™æ ·å†™é“ï¼š</p><blockquote><p>Btrfs scrub is &ldquo;[a]n online filesystem checking tool. Reads all the data and metadata on the filesystem and uses checksums and the duplicate copies from RAID storage to identify and repair any corrupt data.&rdquo;</p></blockquote><p>æŒ‚ä¸Šæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•è¿›è¡Œä¸€æ¬¡æ‰«ææ“ä½œ: <code>sudo btrfs scrub start /</code></p><p>æŸ¥çœ‹è¿›åº¦: <code>sudo btrfs scrub status /</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>UUID:             efeb8313-4210-4499-a805-d0f97e57c549
</span></span><span class=line><span class=cl>Scrub started:    Sun Mar 12 19:53:53 2023
</span></span><span class=line><span class=cl>Status:           running
</span></span><span class=line><span class=cl>Duration:         0:00:05
</span></span><span class=line><span class=cl>Time left:        0:00:14
</span></span><span class=line><span class=cl>ETA:              Sun Mar 12 19:54:16 2023
</span></span><span class=line><span class=cl>Total to scrub:   93.21GiB
</span></span><span class=line><span class=cl>Bytes scrubbed:   24.29GiB  (26.06%)
</span></span><span class=line><span class=cl>Rate:             4.86GiB/s
</span></span><span class=line><span class=cl>Error summary:    no errors found
</span></span></code></pre></td></tr></table></div></div><p>æ‰«æåªç”¨äº†14ç§’ï¼Œ éå¸¸å¿«ï¼</p><h2 id=end>End</h2><p>æˆ‘ä¹Ÿæ˜¯åˆšåˆšä¸Šæ‰‹btrfs, å¦‚æœæœ‰å°å¯çˆ±æœ‰æ›´å¥½çš„å»ºè®®æˆ–è€…å‘ç°å“ªé‡Œå‡ºé”™äº†ï¼Œæ¬¢è¿è¯„è®º or æå‡ºPR~</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/snapper/><div class=article-details><h2 class=article-title>ç”¨Snapperè‡ªåŠ¨ç®¡ç†btrfså¿«ç…§</h2></div></a></article><article><a href=/p/qemu-hostfwd-config/><div class=article-details><h2 class=article-title>ç”¨Virt-Mnangeræ¥é…ç½®qemu hostfwdç«¯å£è½¬å‘</h2></div></a></article></div></div></aside><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script><script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script><script>const gitalk=new Gitalk({clientID:"e61b02a69a03b3124057",clientSecret:"4880b2ae64284f63f338dd2ee61ad9b5af77d47d",repo:"sharelter.github.io",owner:"Sharelter",admin:["Sharelter"],distractionFreeMode:!1,id:md5(location.pathname),proxy:null});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2025 Sharelter</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>